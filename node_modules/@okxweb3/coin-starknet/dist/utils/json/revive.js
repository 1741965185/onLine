"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.revive = void 0;
const LosslessNumber_1 = require("./LosslessNumber");
function revive(json, reviver) {
    return reviveValue({ '': json }, '', json, reviver);
}
exports.revive = revive;
function reviveValue(context, key, value, reviver) {
    if (Array.isArray(value)) {
        return reviver.call(context, key, reviveArray(value, reviver));
    }
    else if (value && typeof value === 'object' && !(0, LosslessNumber_1.isLosslessNumber)(value)) {
        return reviver.call(context, key, reviveObject(value, reviver));
    }
    else {
        return reviver.call(context, key, value);
    }
}
function reviveObject(object, reviver) {
    Object.keys(object).forEach((key) => {
        const value = reviveValue(object, key, object[key], reviver);
        if (value !== undefined) {
            object[key] = value;
        }
        else {
            delete object[key];
        }
    });
    return object;
}
function reviveArray(array, reviver) {
    for (let i = 0; i < array.length; i++) {
        array[i] = reviveValue(array, i + '', array[i], reviver);
    }
    return array;
}
//# sourceMappingURL=revive.js.map